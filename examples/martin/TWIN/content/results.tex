\section{Results}\label{sec-results}

We evaluated the performance of $\twin$ against the best competing methods on \emph{Yersinia kristensenii}, rice and budgerigar.  These three genomes were chosen because they have available sequence and optical mapping data and are diverse in size.   For each dataset, we compared the runtime, peak memory usage, and the number of contigs for which at least one alignment was found for $\twin$, SOMA~\cite{Nagarajan08}, and the software of Valouev et al.~\cite{Valouev06}.  Peak memory was measured as the maximum resident set size as reported by the operating system.  Runtime is the user process time, also reported by the operating system.   SOMA~\cite{Nagarajan08} v2.0 was run with example parameters provided with the tool and the software of Valouev et al.~\cite{Valouev06} was run with its scoring parameters object constructed with arguments (0.2, 2, 1, 5, 17.43, 0.579, 0.005, 0.999, 3, 1). $\twin $ was run with $D_\sigma = 4$, $t = 1000$, and $[250 \ldots 1000]$ for the range of small fragments.
Gentig~\cite{Anantharaman01} and BACop~\cite{Zhou09} were not available for download so we did not test the data using these approaches.      
  
The sequence data was assembled for  \emph{Yersinia kristensenii}, rice and budgerigar by using various assemblers. 
The relevant assembly statistics are given in Table~\ref{tab:assembly_stats}.  An important statistic in this table is the number of contigs that have at least two restriction sites, since contigs with fewer than two are unable to be aligned meaningfully by any method, including $\twin$.  This statistic was computed to reveal cases of ambiguity in placement from lack of information. Indeed, Assemblathon~2 required there to be nine restriction sites present in a contig to align it to the optical mapping data \cite{bradnam2013assemblathon}.  All experiments were performed on Intel x86-64 workstations with sufficient RAM to avoid paging, running  64-bit Linux.

The experiments for \emph{Yersinia kristensenii}, rice and budgerigar illustrate how each of the programs' running time scale as the size of the genome increases.  However, due to the possibility of mis-assemblies in these draft genomes, comparing the actual alignments could possibly lead to erroneous conclusions.  Therefore, we will verify the alignments using simulated {\em E. coli} data.  See Subsection \ref{sec:ecoli} for this experiment.  

%, testing $\twin$ on the slowest in our cluster (a 2.8 GHz Core-2 Duo with 6 GB of RAM).

\input{TWIN/content/table_assembly_statistics}

\subsection{Performance on \emph{Yersinia kristensenii}} \label{sec:pro_genome}

The sequence and optical map data for  \emph{Yersinia kristensenii} are described by Nagarajan {\em et al.} \cite{Nagarajan08}.  The \emph{Yersinia kristensenii} ATCC 33638 reads were generated using 454 GS 20 sequencing and assembled using SPAdes version 3.0.0 \cite{spades} using default parameters.   Contigs from this assembly were aligned against an optical map of the bacterial strain generated by OpGen using the AfIII restriction enzyme.  There are approximately 1.4 million single-end reads for this dataset, and they were obtained from the NCBI Short Read Archive (accession SRX013205).  Of the 92 contigs that could be aligned to the optical map, the software of  Valouev et al. aligned 91 contigs, SOMA aligned 54 contigs, and $\twin$ aligned 61 contigs.  Thus, $\twin$ found more alignments than SOMA, and did so faster. It should be noted that, for this dataset, all three tools had reasonable runtimes. However, while the software of Valouev et al. found more alignments, our validation experiments (below) suggest these results may favor recall over precision, and many of the additional alignments may not be credibled.  


\subsection{Performance on Rice Genome} \label{section:rice}

The second dataset consists of approximately 134 million 76 bp paired-end reads from {\em Oryza sativa Japonica} rice, generated by Illumina, Inc. on the Genome Analayzer (GA) IIx platform, as described by Kawahara {\em et al.} \cite{kawahara2013improvement}.   These reads were obtained from the NCBI Short Read Archive (accession SRX032913) and assembled using SPAdes version 3.0.0 \cite{spades} using default parameters.  The optical map for rice was constructed by Zhou {\em et al.} \cite{RICE} using SwaI as the restriction enzyme.  This optical map was assembled from single molecule restriction maps into 14 optical map contigs, labeled as 12 chromosomes, with chromosome labels 6 and 11 both containing two optical map contigs.

Again, $\twin$ found alignments for more contigs than SOMA on the rice genome.  SOMA and $\twin$ found alignments for 2,434, and 3,098 contigs, respectively, out of 3,103 contigs that could be aligned to the optical map.  However, while SOMA required over 29 minutes to run, $\twin$ required less than one minute. 
The software of Valouev executed faster than SOMA (taking around 3 minutes), though still several times slower than $\twin$ on this modest sized genome.


\subsection{Performance on Budgerigar Genome} \label{section:parrot}

The sequence and optical map data for the budgerigar genome were generated for the Assemblathon~2 project of Bradnam {\em et al.} \cite{bradnam2013assemblathon}.   Sequence data consists of  a combination of Roche 454, Illumina, and Pacific Biosciences reads, providing 16x, 285x, and 10x coverage (respectively) of the genome.  All sequence reads are available at the NCBI Short Read Archive (accession  ERP002324).  For our analysis we consider the assembly generated using Celera~\cite{celera}, which was completed by the CBCB team (Koren and Phillippy) as part of  Assemblathon 2~\cite{bradnam2013assemblathon}.  The optical mapping data was created by Zhou, Goldstein, Place, Schwartz, and Bechner using the SwaI restriction enzyme and consists of 92 separate pieces. %optical map contigs.

As with the two previous data sets, $\twin$ found alignments for more contigs than SOMA on the budgerigar genome.  SOMA and $\twin$ found alignments for 9,668, and 9,826 contigs, respectively, out of 10,019 contigs that could be aligned to the optical map.  However,  SOMA required over 77 days of CPU time and $\twin$ required 35 minutes.  The software of Valouev et al. returned 9,814 alignments and required over an order of magnitude (6.5 hours) of CPU time.  Hence, $\twin$ was the only method that efficiently aligned the {\em in silico} digested budgerigar genome contigs to the optical map.  It should be kept in mind that the competing methods were developed for prokaryote genomes and so we are repurposing them at a scale for which they were not designed.   Lastly, the amount of memory used by all the methods on all experiments was low enough for them to run on a standard workstation.  

We were forced to parallelize SOMA due to the enormous amount of CPU time SOMA required for this dataset.  To accomplish this task, the FASTA file containing the contigs was split into 300 different files, and then IPython Parallel library was used to invoke up to two instances of SOMA on each machine from a set of 150 machines.  Thus, when using a cluster with up to 300 jobs concurrently, the alignment for the budgerigar genome took about a day of wall clock time. In contrast, we ran the software of Valouev et al. and $\twin$ with a single thread running on a single core.  However, it should be noted that the same parallelization could have been accomplished for both these software methods too. Also, even with parallelization of SOMA, $\twin$ is still an order of magnitude faster than it.


\input{TWIN/content/table}

\subsection{Alignment Verification} \label{sec:ecoli}

We compared the alignments given by $\twin$ against the alignments of the contigs of an {\em E. coli} assembly to the \emph{E. Coli} (str. K-12 substr. MG1655) reference genome.  Our prior experiments involved species for which the reference genome may have regions that are mis-asssembled and therefore, contig alignments to the reference genome may be inaccurate and cannot be used for comparison and verification of the {\em in silico} digested contig alignment.   The {\em E. coli} reference genome is likely to contain the fewest errors and thus, is the one we used for assembly verification.  The sequence data consists of approximately 27 million paired-end 100 bp reads from {\em E. coli} (str. K-12 substr. MG1655) generated by Illumina, Inc. on the Genome Analayzer (GA) IIx platform, and  was obtained from the NCBI Short Read Archive (accession ERA000206), and was assembled using SPAdes version 3.0.0 \cite{spades} using default parameters.  This assembly consists of 160 contigs; 50 of which contain two restriction sites, the minimum required for any possible optical alignment, and complete alignments with minimal (\textless 800 bp) total in/dels relative to the reference genome.

We simulated an optical map using the reference genome for {\em E. coli} (str. K-12 substr. MG1655) since there is no publicly available one for this genome.  

The 50 contigs that contained more than two restriction sites were aligned to the reference genome using BLAT~\cite{blat}.  These same contigs were then {\em in silico} digested and aligned to the optical map using $\twin$.  The resulting PSL files were then compared.  $\twin$ found alignment positions within 10\% of those found by BLAT for all 50 contigs, justifying that our method is finding correct alignments.  We repeated this verification approach with both SOMA and the software from Valouev.  All of SOMA's reported alignments had matching BLAT alignments, while of the 49 alignments the software from Valuoev reported, only 18 could be matched with alignments from BLAT.
